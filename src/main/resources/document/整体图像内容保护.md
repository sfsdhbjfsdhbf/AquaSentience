# 整体内容保护：基于频域 Transformer 的鲁棒图像水印方法

## 1. 研究背景
数字图像在传播过程中常遭受多种破坏：JPEG 压缩、噪声、裁剪、屏幕拍摄、甚至扩散模型再生成。传统 CNN 空间域水印方法难以建模长距离依赖，也难以处理序列化的 DCT 频域特征，因此在屏摄攻击与生成式攻击下鲁棒性不足。

## 2. 方法概述
提出 EDBFormer（Efficient Dual-Branch Transformer）：
- 空间分支：寻找适合嵌入的图像结构区域。
- 频域分支：选择稳定、抗压缩的频率通道。
- DSFFN 动态门控融合两类特征。
- DCT 系数重排 + 低秩加速提高效率与稳定性。

## 3. 方法流程
1. Cover Image 进行 DCT → 频域特征。
2. 将 Watermark reshape 后拼接至频域特征。
3. 输入 EDBFormer（空间 + 频域）。
4. 逆 DCT → 得到初始水印图像。
5. 使用 SWM 注意力调整嵌入强度。
6. Perturbation module 模拟 JPEG、模糊、噪声、色彩变化、透视变换等。
7. Decoder 通过 STN 校正畸变 → 提取水印。

## 4. 特点
- 能适应屏摄、生成式再生成等极端攻击。
- 同时保持较高容量、隐蔽性、鲁棒性。
